{% extends "dashboard/base.html" %}
{% load static %}


{% block content %}
<div class="col-lg-12 grid-margin stretch-card">
  <div class="card">
    <div class="card-body">
      <h4 class="card-title">KPIlar jadvali</h4>
      <p class="card-description">
        Hozzirgi kunda mavjud KPI lar jadvali.
      </p>
      <div class="table-responsive pt-3">
        <table class="table table-bordered">
          <thead>
            <tr>
              <th>
                #
              </th>
              <th>
                KPI
              </th>
              <th>
                Ball
              </th>
              <th>
                Mas'ul shaxs
              </th>
              <th>
                Ta'rif
              </th>
            </tr>
          </thead>
          <tbody>

            {% for kpi in kpis %}
              <tr>
                <td>
                  {{ forloop.counter }}
                </td>
                <td>
                    {% if user.role == root_user.ADMIN %}
                      <a href="{% url "dashboard:kpi-detail" kpi.id %}">{{ kpi.name }}</a>
                    {% elif user.role == root_user.EMPLOYEE %}
                      <a href="{% url "dashboard:metrics" kpi.id %}">{{ kpi.name }}</a>
                    {% endif %}
                </td>
                <td>
                  {{ kpi.total_ball }}
                </td>
                <td>
                  {{ kpi.responsible_employee.full_name }}
                </td>
                <td>
                  {{ kpi.description }}
                </td>
              </tr>
            {% endfor %}

          </tbody>
        </table>
      </div>

      {% if user.role == root_user.ADMIN %}
        </br>
        <div class="template-demo" style="text-align: center">
          <div class="btn-group" role="group" aria-label="Basic example">
              <a class="btn btn-inverse-primary" href="{% url "dashboard:kpi-create" %}">Yaratish</a>
          </div>
        </div>
      {% endif %}
      
    </div>
  </div>
</div>

{% endblock content %}